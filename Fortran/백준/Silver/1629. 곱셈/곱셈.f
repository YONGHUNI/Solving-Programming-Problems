IMPLICIT NONE
INTEGER*16::L,N,M,I

READ*,L,N,M


CALL POWER(L,N,M,I)

PRINT"(I0)",I

CONTAINS

RECURSIVE SUBROUTINE POWER(A,B,C,RES)

IMPLICIT NONE
INTEGER*16, TARGET, INTENT(INOUT) :: A,B,C,RES
INTEGER*16::TMP,TMP2
   

IF(B==1)THEN

    RES = MOD(A,C)

ELSE
    
    TMP2 = B/2
    
    CALL POWER(A,TMP2,C,TMP)
    
    IF(MOD(B,2)==0)THEN
    
        RES = MOD(TMP**2,C)
    
    ELSE
    
        RES = MOD(A*(TMP**2),C)
    
    END IF

END IF


END SUBROUTINE POWER
END